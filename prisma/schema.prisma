generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Mail Setup Configuration
model mailsetup {
  id           Int      @id @default(autoincrement())
  smtphost     String   @map("smtp_host")
  smtpport     Int      @map("smtp_port")
  smtpuser     String   @map("smtp_user")
  smtppassword String   @map("smtp_password")
  enablessl    Boolean  @default(false) @map("enable_ssl")
  sendername   String   @map("sender_name")
  senderemail  String   @map("sender_email")
  createdat    DateTime @default(now()) @map("created_at")
  updatedat    DateTime @updatedAt @map("updated_at")

  @@map("mail_setup")
}

// Customer master
model customermaster {
  id            Int                 @id @default(autoincrement())
  name          String              @db.VarChar(500)
  details       String?             @db.VarChar(500)
  contactPerson String?             @map("contact_person") @db.VarChar(50)
  email         String?             @db.VarChar(100)
  address       String?             @db.Text
  status        String              @default("active") @db.VarChar(15)
  createdat     DateTime            @default(now()) @map("created_at")
  updatedat     DateTime            @updatedAt @map("updated_at")
  
  locations     customerlocation[]
  invoices      invoice[]
  amcproposals  amcproposal[]

  @@map("customer_master")
}

// Customer locations
model customerlocation {
  id            Int            @id @default(autoincrement())
  customerId    Int            @map("customer_id")
  displayName   String         @map("display_name") @db.VarChar(500)
  location      String?        @db.VarChar(150)
  contactPerson String?        @map("contact_person") @db.VarChar(150)
  email         String?        @db.VarChar(100)
  phone1        String?        @map("phone1") @db.VarChar(15)
  phone2        String?        @map("phone2") @db.VarChar(15)
  address       String?        @db.Text
  city          String?        @db.VarChar(50)
  state         String?        @db.VarChar(50)
  pin           String?        @db.VarChar(10)
  gstin         String?        @db.VarChar(15)
  pan           String?        @db.VarChar(15)
  status        String         @default("active") @db.VarChar(15)
  createdat     DateTime       @default(now()) @map("created_at")
  updatedat     DateTime       @updatedAt @map("updated_at")
  
  customer      customermaster @relation(fields: [customerId], references: [id], onDelete: Cascade)
  invoices      invoice[]
  proposalitems proposalitem[]

  @@map("customer_locations")
}

// Brand
model brand {
  id        Int       @id @default(autoincrement())
  name      String    @db.VarChar(200)
  details   String?   @db.VarChar(500)
  status    String    @default("active") @db.VarChar(15)
  createdat DateTime  @default(now()) @map("created_at")
  updatedat DateTime  @updatedAt @map("updated_at")
  
  products  product[]

  @@map("brands")
}

// category
model category {
  id        Int       @id @default(autoincrement())
  name      String    @db.VarChar(200)
  details   String?   @db.VarChar(500)
  status    String    @default("active") @db.VarChar(15)
  createdat DateTime  @default(now()) @map("created_at")
  updatedat DateTime  @updatedAt @map("updated_at")
  
  products  product[]

  @@map("categories")
}

// Product
model product {
  id          Int            @id @default(autoincrement())
  name        String         @db.VarChar(500)
  details     String?        @db.Text
  brandId     Int?           @map("brand_id")
  categoryId  Int?           @map("category_id")
  model       String?        @db.VarChar(200)
  status      String         @default("active") @db.VarChar(15)
  createdat   DateTime       @default(now()) @map("created_at")
  updatedat   DateTime       @updatedAt @map("updated_at")
  
  brand        brand?         @relation(fields: [brandId], references: [id], onDelete: SetNull)
  category     category?      @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  invoiceItems invoiceitem[]
  proposalitems proposalitem[]

  @@map("products")
}

// Invoice
model invoice {
  id         Int                @id @default(autoincrement())
  customerId Int                @map("customer_id")
  locationId Int?               @map("location_id")
  invoiceNo  String             @unique @map("invoice_no") @db.VarChar(50)
  invoiceDate DateTime          @map("invoice_date")
  total      Decimal            @db.Decimal(10, 2)
  discount   Decimal            @default(0) @db.Decimal(10, 2)
  subtotal   Decimal            @db.Decimal(10, 2)
  grandTotal Decimal            @map("grand_total") @db.Decimal(10, 2)
  status     String             @default("pending") @db.VarChar(20)
  createdat  DateTime           @default(now()) @map("created_at")
  updatedat  DateTime           @updatedAt @map("updated_at")
  
  customer      customermaster     @relation(fields: [customerId], references: [id], onDelete: Cascade)
  location      customerlocation?  @relation(fields: [locationId], references: [id], onDelete: SetNull)
  items         invoiceitem[]
  proposalitems proposalitem[]

  @@map("invoices")
}

// Invoice Items
model invoiceitem {
  id        Int      @id @default(autoincrement())
  invoiceId Int      @map("invoice_id")
  productId Int      @map("product_id")
  serialNo  String?  @map("serial_no") @db.VarChar(100)
  quantity  Int      @default(1)
  amount    Decimal  @db.Decimal(10, 2)
  createdat DateTime @default(now()) @map("created_at")
  updatedat DateTime @updatedAt @map("updated_at")
  
  invoice   invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  product   product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("invoice_items")
}

// Admin Users (for authentication)
model adminuser {
  id        Int      @id @default(autoincrement())
  email     String   @unique @db.VarChar(100)
  password  String
  name      String   @db.VarChar(200)
  role      String   @default("admin") @db.VarChar(50)
  status    String   @default("active") @db.VarChar(15)
  createdat DateTime @default(now()) @map("created_at")
  updatedat DateTime @updatedAt @map("updated_at")

  @@map("admin_users")
}

// AMC Proposal
model amcproposal {
  id               Int      @id @default(autoincrement())
  proposalno       String   @unique @map("proposal_no") @db.VarChar(50)
  proposaldate     DateTime @map("proposal_date")
  amcstartdate     DateTime @map("amc_start_date")
  amcenddate       DateTime @map("amc_end_date")
  customerId       Int      @map("customer_id")
  contractno       String?  @map("contract_no") @db.VarChar(100)
  billingaddress   String?  @map("billing_address") @db.Text
  doclink          String?  @map("doc_link") @db.Text
  termsconditions  String?  @map("terms_conditions") @db.Text
  total            Decimal  @default(0) @db.Decimal(10, 2)
  additionalcharge Decimal  @default(0) @map("additional_charge") @db.Decimal(10, 2)
  discount         Decimal  @default(0) @db.Decimal(10, 2)
  taxrate          Decimal  @default(0) @map("tax_rate") @db.Decimal(5, 2)
  taxamount        Decimal  @default(0) @db.Decimal(10, 2)
  grandtotal       Decimal  @default(0) @map("grand_total") @db.Decimal(10, 2)
  proposalstatus   String   @default("new") @map("proposal_status") @db.VarChar(20)
  createdat        DateTime @default(now()) @map("created_at")
  updatedat        DateTime @updatedAt @map("updated_at")
  
  customer         customermaster @relation(fields: [customerId], references: [id], onDelete: Cascade)
  items            proposalitem[]

  @@map("amc_proposals")
}

// Proposal Items
model proposalitem {
  id         Int                @id @default(autoincrement())
  proposalId Int                @map("proposal_id")
  locationId Int?               @map("location_id")
  invoiceId  Int                @map("invoice_id")
  productId  Int                @map("product_id")
  serialno   String?            @map("serial_no") @db.VarChar(100)
  saccode    String?            @map("sac_code") @db.VarChar(20)
  quantity   Int                @default(1)
  rate       Decimal            @db.Decimal(10, 2)
  amount     Decimal            @db.Decimal(10, 2)
  createdat  DateTime           @default(now()) @map("created_at")
  updatedat  DateTime           @updatedAt @map("updated_at")
  
  proposal   amcproposal        @relation(fields: [proposalId], references: [id], onDelete: Cascade)
  location   customerlocation?  @relation(fields: [locationId], references: [id], onDelete: SetNull)
  invoice    invoice            @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  product    product            @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@map("proposal_items")
}

// Proposal Document Tracking
model proposaldocument {
  id         Int      @id @default(autoincrement())
  proposalno String   @map("proposal_no") @db.VarChar(50)
  doclink    String   @map("doc_link") @db.Text
  createdby  String   @map("created_by") @db.VarChar(200)
  createdat  DateTime @default(now()) @map("created_at")
  updatedat  DateTime @updatedAt @map("updated_at")

  @@map("proposal_documents")
}

// Email Record Tracking
model emailrecord {
  id         Int      @id @default(autoincrement())
  proposalno String   @map("proposal_no") @db.VarChar(50)
  email      String   @db.VarChar(100)
  status     String   @db.VarChar(20)
  sentby     String   @map("sent_by") @db.VarChar(200)
  message    String?  @db.Text
  createdat  DateTime @default(now()) @map("created_at")
  updatedat  DateTime @updatedAt @map("updated_at")

  @@map("email_records")
}
